<html>
<head>
  <title>Calculus: limit</title>
  <style>
    table, th, tr, td {
      border: 1px solid black
    }
  </style>
  <script type="text/javascript">
    function inlineFractionsToMathML(text) {
      // match inline math expression and replace with MathML
      // currently support
      // - fractions: must be in format (...)/(...)
      // - power: e.g. x^2, (x+1)^2, (3x+1)^(2x)
      // - limit: the "approach" must be in parentheses
      text = text.replace(/->|-&gt;/g, "→");
      text = text.replace(/([+\-*→])/g, "<mo>$1</mo>");
      // has to do it this way because of how each open/close bracket has to be explicitly written in MathML
      text = text.replace(/\((.+?)\)\^\((.+?)\)/g, "<msup><mrow><mo>(</mo>$1<mo>)</mo></mrow><mrow><mo>(</mo>$2<mo>)</mo></mrow></msup>");
      text = text.replace(/\((.+?)\)\^([^() ]+)/g, "<msup><mrow><mo>(</mo>$1<mo>)</mo></mrow><mrow>$2</mrow></msup>");
      text = text.replace(/([^() ]+)\^\((.+?)\)/g, "<msup><mrow>$1</mrow><mrow><mo>(</mo>$2<mo>)</mo></mrow></msup>");
      text = text.replace(/([^() ]+)\^([^() ]+)/g, "<msup><mrow>$1</mrow><mrow>$2</mrow></msup>");
      text = text.replace(/(\d+)/g, "<mn>$1</mn>");
      text = text.replace(/(?<![a-z])([a-z])(?![a-z])/g, "<mi>$1</mi>");
      text = text.replace(/lim *\((.+?)\)/g, "<munder><ms>lim</ms><mrow>$1</mrow></munder>");
      text = text.replace(/\((.+?)\)\/\((.+?)\)/g, "<mfrac><mrow>$1</mrow><mrow>$2</mrow></mfrac>");
      return text;
    }

    function toggle_answer() {
      if (true || document.getElementById("answer").style.display === "none") {
        document.getElementById("answer").style.display = "block";
        //document.getElementById("toggle_button").innerHTML = "hide answer";
        document.getElementById("equation_ml").innerHTML = inlineFractionsToMathML(document.getElementById("equation").value);
      } else {
        document.getElementById("answer").style.display = "none";
        document.getElementById("toggle_button").innerHTML = "show answer";
      }
    }
  </script>
</head>
<body>
<table>
  <tr>
    <th style="width:300px">Problem</th>
    <th>Answer</th>
  </tr>
  <tr>
    <td>
      <input type="text" id="equation" style="width: 280px"/><br>
    </td>
    <td>
      <span id="answer" style="display:none"></span>
      <math id="equation_ml"></math><br>
    </td>
  </tr>
</table>
<button id="toggle_button" onclick="toggle_answer() ">beautify!</button>
</body>
</html>
